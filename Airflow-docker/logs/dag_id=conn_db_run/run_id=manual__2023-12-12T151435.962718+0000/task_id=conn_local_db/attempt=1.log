[2023-12-12T15:14:37.018+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: conn_db_run.conn_local_db manual__2023-12-12T15:14:35.962718+00:00 [queued]>
[2023-12-12T15:14:37.026+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: conn_db_run.conn_local_db manual__2023-12-12T15:14:35.962718+00:00 [queued]>
[2023-12-12T15:14:37.027+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2023-12-12T15:14:37.037+0000] {taskinstance.py:1382} INFO - Executing <Task(_PythonDecoratedOperator): conn_local_db> on 2023-12-12 15:14:35.962718+00:00
[2023-12-12T15:14:37.044+0000] {standard_task_runner.py:57} INFO - Started process 5073 to run task
[2023-12-12T15:14:37.047+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'conn_db_run', 'conn_local_db', 'manual__2023-12-12T15:14:35.962718+00:00', '--job-id', '99', '--raw', '--subdir', 'DAGS_FOLDER/test_postgres_1212.py', '--cfg-path', '/tmp/tmp8get93ot']
[2023-12-12T15:14:37.052+0000] {standard_task_runner.py:85} INFO - Job 99: Subtask conn_local_db
[2023-12-12T15:14:37.095+0000] {task_command.py:416} INFO - Running <TaskInstance: conn_db_run.conn_local_db manual__2023-12-12T15:14:35.962718+00:00 [running]> on host 7fd8dd875aa1
[2023-12-12T15:14:37.147+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='conn_db_run' AIRFLOW_CTX_TASK_ID='conn_local_db' AIRFLOW_CTX_EXECUTION_DATE='2023-12-12T15:14:35.962718+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-12-12T15:14:35.962718+00:00'
[2023-12-12T15:14:37.155+0000] {base.py:73} INFO - Using connection ID 'postgres_conn' for task execution.
[2023-12-12T15:14:37.198+0000] {logging_mixin.py:154} INFO - Type of result: <class 'list'>
[2023-12-12T15:14:37.198+0000] {logging_mixin.py:154} INFO - Value of result: [('中華路-育樂街', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.960000')), ('中園路-吉林路', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.980000')), ('環中東路-中山東路', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.950000')), ('環北路-延平路(延平路)', '桃園市 中壢區', Decimal('121.230000'), Decimal('24.960000')), ('環北路-延平路(環北路)', '桃園市 中壢區', Decimal('121.230000'), Decimal('24.960000')), ('環北路-慈惠三街', '桃園市 中壢區', Decimal('121.230000'), Decimal('24.970000')), ('環北路-新生路', '桃園市 中壢區', Decimal('121.220000'), Decimal('24.970000')), ('環北路-中豐北路(環北路)', '桃園市 中壢區', Decimal('121.220000'), Decimal('24.970000')), ('環北路-中豐北路(中豐北路)', '桃園市 中壢區', Decimal('121.220000'), Decimal('24.970000')), ('環西路-民權路', '桃園市 中壢區', Decimal('121.220000'), Decimal('24.970000')), ('環西路-志廣路', '桃園市 中壢區', Decimal('121.210000'), Decimal('24.960000')), ('中華路興仁路口(久丹努眼鏡行前號誌桿)', '桃園市 中壢區', Decimal('121.260000'), Decimal('24.970000')), ('中華路中園路口(YKK與家具行出入口間號誌桿)', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.960000')), ('中華路自強一路口(華麒工業前號誌桿)', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.970000')), ('環中東路龍岡路口(三陽工業前號誌桿)', '桃園市 中壢區', Decimal('121.230000'), Decimal('24.940000')), ('中山東路中北路口(85C咖啡對面中北路號誌桿)', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.960000')), ('環西路與民族路口(空地前號誌桿)', '桃園市 中壢區', Decimal('121.210000'), Decimal('24.960000')), ('南園二路與中福路口前', '桃園市 中壢區', Decimal('121.230000'), Decimal('24.970000')), ('中華路二段與忠義路前分隔島(昇降桿)', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.960000')), ('東園路吉林路口', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.980000')), ('環中東路永福路口', '桃園市 中壢區', Decimal('121.260000'), Decimal('24.960000')), ('普忠路中華路口', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.970000')), ('五青路-領航南路', '桃園市 中壢區', Decimal('121.230000'), Decimal('25.020000')), ('中華路二段128號前中央分隔島', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.970000')), ('青埔路二段-高鐵北路一段', '桃園市 中壢區', Decimal('121.210000'), Decimal('25.010000')), ('高鐵站前東路二段-領航南路三段', '桃園市 中壢區', Decimal('121.220000'), Decimal('25.010000')), ('青昇路與高鐵北路二段', '桃園市 中壢區', Decimal('121.220000'), Decimal('25.020000')), ('中山南路二段與領航北路三段', '桃園市 中壢區', Decimal('121.210000'), Decimal('25.020000')), ('中豐北路二段與高鐵南路二段、領航北路一段', '桃園市 中壢區', Decimal('121.200000'), Decimal('25.000000')), ('內壢交流道往大園方向', '桃園市 中壢區', Decimal('121.240000'), Decimal('24.990000')), ('高鐵南路三段與中正路三段', '桃園市 中壢區', Decimal('121.190000'), Decimal('24.990000')), ('環中東路-普忠路', '桃園市 中壢區', Decimal('121.250000'), Decimal('24.960000'))]
[2023-12-12T15:14:37.199+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/decorators/base.py", line 221, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/test_postgres_1212.py", line 25, in conn_local_db
    return json.dumps(float(result[0]))
TypeError: float() argument must be a string or a number, not 'tuple'
[2023-12-12T15:14:37.207+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=conn_db_run, task_id=conn_local_db, execution_date=20231212T151435, start_date=20231212T151437, end_date=20231212T151437
[2023-12-12T15:14:37.217+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 99 for task conn_local_db (float() argument must be a string or a number, not 'tuple'; 5073)
[2023-12-12T15:14:37.260+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2023-12-12T15:14:37.274+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
